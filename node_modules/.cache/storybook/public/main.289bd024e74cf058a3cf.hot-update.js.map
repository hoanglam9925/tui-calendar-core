{"version":3,"file":"main.289bd024e74cf058a3cf.hot-update.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAZA;;AAeA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AAIA;;AAEA;AACA;AACA;AAEA;AACA;AAIA;AAAA;AAAA;AAAA;AACA;;AAEA;AACA;AAAA;;AACA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AAAA;AAAA;AAAA;;AACA;AAAA;AAAA;AAAA;;AACA;AAAA;AAAA;AAAA;;AAIA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;;AAEA;AAAA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAMA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AACA;AACA;AAFA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;AAYA;AACA;AAAA;AAAA;AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAGA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAOA;AACA;AAAA;AAAA;AAFA;AAIA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAMA;;;;;;;;;;;;;;;;;;;;;AChMA;AAEA;AACA;AACA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;;AAcA;AAAA;;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAKA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAKA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAKA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAKA;AAAA;AAEA;AACA;AACA;AADA;AAFA;AAMA;AAAA;AAIA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAMA;;;;;;;;;;;;;;;;;ACnFA;AAEA;AACA;AAOA;AACA;AACA;AACA;AAHA;AAMA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AAIA","sources":["webpack://@toast-ui/calendar/./src/components/popup/eventDetailPopup.tsx","webpack://@toast-ui/calendar/./src/components/popup/eventDetailSectionDetail.tsx","webpack://@toast-ui/calendar/./src/components/popup/eventDetailSectionHeader.tsx"],"sourcesContent":["import { h } from 'preact';\nimport { createPortal } from 'preact/compat';\nimport { useLayoutEffect, useMemo, useRef, useState } from 'preact/hooks';\n\nimport { EventDetailSectionDetail } from '@src/components/popup/eventDetailSectionDetail';\nimport { EventDetailSectionHeader } from '@src/components/popup/eventDetailSectionHeader';\nimport { Template } from '@src/components/template';\nimport { DetailPopupArrowDirection, HALF_OF_POPUP_ARROW_HEIGHT } from '@src/constants/popup';\nimport { useDispatch, useStore } from '@src/contexts/calendarStore';\nimport { useEventBus } from '@src/contexts/eventBus';\nimport { useFloatingLayer } from '@src/contexts/floatingLayer';\nimport { useLayoutContainer } from '@src/contexts/layoutContainer';\nimport { cls } from '@src/helpers/css';\nimport { isLeftOutOfLayout, isTopOutOfLayout } from '@src/helpers/popup';\nimport { useCalendarColor } from '@src/hooks/calendar/useCalendarColor';\nimport { optionsSelector } from '@src/selectors';\nimport { eventDetailPopupParamSelector } from '@src/selectors/popup';\nimport TZDate from '@src/time/date';\nimport { isNil } from '@src/utils/type';\n\nimport type { StyleProp } from '@t/components/common';\nimport type { Rect } from '@t/store';\n\nconst classNames = {\n  popupContainer: cls('popup-container'),\n  detailContainer: cls('detail-container'),\n  topLine: cls('popup-top-line'),\n  border: cls('popup-arrow-border'),\n  fill: cls('popup-arrow-fill'),\n  sectionButton: cls('popup-section', 'section-button'),\n  content: cls('content'),\n  editIcon: cls('icon', 'ic-edit'),\n  deleteIcon: cls('icon', 'ic-delete'),\n  editButton: cls('edit-button'),\n  deleteButton: cls('delete-button'),\n  verticalLine: cls('vertical-line'),\n};\n\nfunction calculatePopupPosition(eventRect: Rect, layoutRect: Rect, popupRect: Rect) {\n  let top = eventRect.top + eventRect.height / 2 - popupRect.height / 2;\n  let left = eventRect.left + eventRect.width;\n\n  if (isTopOutOfLayout(top, layoutRect, popupRect)) {\n    top = layoutRect.top + layoutRect.height - popupRect.height;\n  }\n\n  if (isLeftOutOfLayout(left, layoutRect, popupRect)) {\n    left = eventRect.left - popupRect.width;\n  }\n\n  return [\n    Math.max(top, layoutRect.top) + window.scrollY,\n    Math.max(left, layoutRect.left) + window.scrollX,\n  ];\n}\n\nfunction calculatePopupArrowPosition(eventRect: Rect, layoutRect: Rect, popupRect: Rect) {\n  const top = eventRect.top + eventRect.height / 2 + window.scrollY;\n  const popupLeft = eventRect.left + eventRect.width;\n\n  const isOutOfLayout = popupLeft + popupRect.width > layoutRect.left + layoutRect.width;\n  const direction = isOutOfLayout\n    ? DetailPopupArrowDirection.right\n    : DetailPopupArrowDirection.left;\n\n  return { top, direction };\n}\n\nexport function EventDetailPopup() {\n  const { useFormPopup } = useStore(optionsSelector);\n  const popupParams = useStore(eventDetailPopupParamSelector);\n  const { event, eventRect } = popupParams ?? {};\n\n  const { showFormPopup, hideDetailPopup } = useDispatch('popup');\n\n  const calendarColor = useCalendarColor(event);\n  const layoutContainer = useLayoutContainer();\n  const detailPopupSlot = useFloatingLayer('detailPopupSlot');\n  const eventBus = useEventBus();\n  const popupContainerRef = useRef<HTMLDivElement>(null);\n\n  const [style, setStyle] = useState<StyleProp>({});\n  const [arrowTop, setArrowTop] = useState<number>(0);\n  const [arrowDirection, setArrowDirection] = useState<DetailPopupArrowDirection>(\n    DetailPopupArrowDirection.left\n  );\n\n  const popupArrowClassName = useMemo(() => {\n    const right = arrowDirection === DetailPopupArrowDirection.right;\n    const left = arrowDirection === DetailPopupArrowDirection.left;\n\n    return cls('popup-arrow', { right, left });\n  }, [arrowDirection]);\n\n  useLayoutEffect(() => {\n    if (popupContainerRef.current && eventRect && layoutContainer) {\n      const layoutRect = layoutContainer.getBoundingClientRect();\n      const popupRect = popupContainerRef.current.getBoundingClientRect();\n\n      const [top, left] = calculatePopupPosition(eventRect, layoutRect, popupRect);\n      const { top: arrowTopPosition, direction } = calculatePopupArrowPosition(\n        eventRect,\n        layoutRect,\n        popupRect\n      );\n\n      setStyle({ top, left });\n      setArrowTop(arrowTopPosition - top - HALF_OF_POPUP_ARROW_HEIGHT);\n      setArrowDirection(direction);\n    }\n  }, [eventRect, layoutContainer]);\n\n  if (isNil(event) || isNil(eventRect) || isNil(detailPopupSlot)) {\n    return null;\n  }\n\n  const {\n    title = '',\n    isAllday = false,\n    start = new TZDate(),\n    end = new TZDate(),\n    location,\n    state,\n    isReadOnly,\n    isPrivate,\n  } = event;\n\n  const popupArrowPointPosition = {\n    top: eventRect.top + eventRect.height / 2,\n    left: eventRect.left + eventRect.width / 2,\n  };\n\n  const onClickEditButton = () => {\n    if (useFormPopup) {\n      showFormPopup({\n        isCreationPopup: false,\n        event,\n        title,\n        location,\n        start,\n        end,\n        isAllday,\n        isPrivate,\n        eventState: state,\n        popupArrowPointPosition,\n      });\n    } else {\n      eventBus.fire('beforeUpdateEvent', { event: event.toEventObject(), changes: {} });\n    }\n  };\n\n  const onClickDeleteButton = () => {\n    eventBus.fire('beforeDeleteEvent', event.toEventObject());\n    hideDetailPopup();\n  };\n\n  return createPortal(\n    // <div>Ã¡dsadasdasdasd</div>,\n    <div role=\"dialog\" className={classNames.popupContainer} ref={popupContainerRef} style={style}>\n      <div className={classNames.detailContainer}>\n        <EventDetailSectionHeader event={event} />\n        <EventDetailSectionDetail event={event} />\n        {!isReadOnly && (\n          <div className={classNames.sectionButton}>\n            <button type=\"button\" className={classNames.editButton} onClick={onClickEditButton}>\n              <span className={classNames.editIcon} />\n              <span className={classNames.content}>\n                <Template template=\"popupEdit\" as=\"span\" />\n              </span>\n            </button>\n            <div className={classNames.verticalLine} />\n            <button type=\"button\" className={classNames.deleteButton} onClick={onClickDeleteButton}>\n              <span className={classNames.deleteIcon} />\n              <span className={classNames.content}>\n                <Template template=\"popupDelete\" as=\"span\" />\n              </span>\n            </button>\n          </div>\n        )}\n      </div>\n      <div\n        className={classNames.topLine}\n        style={{ backgroundColor: calendarColor.backgroundColor }}\n      />\n      <div className={popupArrowClassName}>\n        <div className={classNames.border} style={{ top: arrowTop }}>\n          <div className={classNames.fill} />\n        </div>\n      </div>\n    </div>,\n    detailPopupSlot\n  );\n}\n","import { h } from 'preact';\n\nimport { Template } from '@src/components/template';\nimport { cls } from '@src/helpers/css';\nimport { useCalendarById } from '@src/hooks/calendar/useCalendarById';\nimport type EventModel from '@src/model/eventModel';\n\ninterface Props {\n  event: EventModel;\n}\n\nconst classNames = {\n  detailItem: cls('detail-item'),\n  detailItemIndent: cls('detail-item', 'detail-item-indent'),\n  detailItemSeparate: cls('detail-item', 'detail-item-separate'),\n  sectionDetail: cls('popup-section', 'section-detail'),\n  content: cls('content'),\n  locationIcon: cls('icon', 'ic-location-b'),\n  repeatIcon: cls('icon', 'ic-repeat-b'),\n  userIcon: cls('icon', 'ic-user-b'),\n  stateIcon: cls('icon', 'ic-state-b'),\n  calendarDotIcon: cls('icon', 'calendar-dot'),\n};\n\n// eslint-disable-next-line complexity\nexport function EventDetailSectionDetail({ event }: Props) {\n  const { location, recurrenceRule, attendees, state, calendarId, body } = event;\n  const calendar = useCalendarById(calendarId);\n\n  return (\n    <div className={classNames.sectionDetail}>\n      {location && (\n        <div className={classNames.detailItem}>\n          <span className={classNames.locationIcon} />\n          <span className={classNames.content}>\n            <Template template=\"popupDetailLocation\" param={event} as=\"span\" />\n          </span>\n        </div>\n      )}\n      {recurrenceRule && (\n        <div className={classNames.detailItem}>\n          <span className={classNames.repeatIcon} />\n          <span className={classNames.content}>\n            <Template template=\"popupDetailRecurrenceRule\" param={event} as=\"span\" />\n          </span>\n        </div>\n      )}\n      {attendees && (\n        <div className={classNames.detailItemIndent}>\n          <span className={classNames.userIcon} />\n          <span className={classNames.content}>\n            <Template template=\"popupDetailAttendees\" param={event} as=\"span\" />\n          </span>\n        </div>\n      )}\n      {state && (\n        <div className={classNames.detailItem}>\n          <span className={classNames.stateIcon} />\n          <span className={classNames.content}>\n            <Template template=\"popupDetailState\" param={event} as=\"span\" />\n          </span>\n        </div>\n      )}\n      {calendar && (\n        <div className={classNames.detailItem}>\n          <span\n            className={classNames.calendarDotIcon}\n            style={{\n              backgroundColor: calendar?.backgroundColor ?? '',\n            }}\n          />\n          <span className={classNames.content}>{calendar?.name ?? ''}</span>\n        </div>\n      )}\n      {body && (\n        <div className={classNames.detailItemSeparate}>\n          <span className={classNames.content}>\n            <Template template=\"popupDetailBody\" param={event} as=\"span\" />\n          </span>\n        </div>\n      )}\n    </div>\n  );\n}\n","import { h } from 'preact';\n\nimport { Template } from '@src/components/template';\nimport { cls } from '@src/helpers/css';\nimport type EventModel from '@src/model/eventModel';\n\ninterface Props {\n  event: EventModel;\n}\n\nconst classNames = {\n  sectionHeader: cls('popup-section', 'section-header'),\n  content: cls('content'),\n  eventTitle: cls('event-title'),\n};\n\nexport function EventDetailSectionHeader({ event }: Props) {\n  return (\n    <div className={classNames.sectionHeader}>\n      <div className={classNames.eventTitle}>\n        <Template template=\"popupDetailTitle\" param={event} as=\"span\" />\n      </div>\n      <div className={classNames.content}>\n        <Template template=\"popupDetailDate\" param={event} as=\"span\" />\n      </div>\n    </div>\n  );\n}\n"],"names":[],"sourceRoot":""}